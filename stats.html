document.addEventListener('DOMContentLoaded', async () => {
  try {
    const excelUrl = 'https://raw.githubusercontent.com/Evelez23/-microdelecion/main/listaPacientes.xlsx';
    const response = await fetch(excelUrl);
    
    // Depuración paso a paso
    console.log("Respuesta HTTP:", response.status); // Debe ser 200
    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
    
    const data = await response.arrayBuffer();
    console.log("Datos descargados:", data.byteLength, "bytes"); // Debe ser > 0
    
    const workbook = read(data);
    console.log("Hojas disponibles:", workbook.SheetNames); // Debe mostrar ["Sheet1"]
    
    const pacientes = utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);
    console.log("Primer paciente:", pacientes[0]); // Verifica estructura
    
    // Resto de tu código...
  } catch (error) {
    console.error("Error completo:", error);
  }
});
